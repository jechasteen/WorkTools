<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Listulator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+EAN13+Text&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+EAN13+Text&display=swap" rel="stylesheet">
    <style>/* CSS Reset */

html {
    box-sizing: border-box;
    font-size: 16px;
}

*,
*:before,
*:after {
    box-sizing: inherit;
}

body,
h1,
h2,
h3,
h4,
h5,
h6,
p,
ol,
ul {
    margin: 0;
    padding: 0;
    font-weight: normal;
}

ol,
ul {
    list-style: none;
}

img {
    max-width: 100%;
    height: auto;
}

/* End CSS Reset */

/* This gets rid of the header and footer, really */
@page {
    margin: 0;
}

body {
    margin: 0.25in;
}

h1, h2, h4 {
    width: 100%;
    text-align: center;
}

h2 {
    margin-top: 2em;
    border-bottom: 1px solid gray;
}

h4 {
    margin-top: 2em;
}

.barcode {
    display: inline-block;
    padding: 0 !important;
    font-family: "Libre Barcode EAN13 Text", system-ui;
    font-style: normal;
    font-size: 100px;
    transform: scaleY(0.5);
    -webkit-transform: scaleY(0.5);
    -moz-transform: scaleY(0.5);
}

.flex {
    text-align: center;
    display: grid;
    grid-auto-flow: row;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    margin-bottom: 1em;
}

body {
    font-family: "owners-text", sans-serif;
    font-weight: 400;
    font-style: normal;
    padding: 1em 0 1em 2em;
}</style>
</head>
<body>
    <h1>Barcode Listulator</h1>
    <hr>
    <details>
        <summary>Help</summary>
        <p>
            This tool can create printable barcode lists.
        </p>
        <p>
            Use the text field below to insert the data you'd like to present.
            Gathering the UPCs is relatively easier if you use a mobile app.
            If you'd like to organize and annotate your barcodes, use the
            following format. Otherwise, a list of UPCs -- only one on each line
            -- will result in a list of barcodes only with no additional text.
        </p>
        <p>
            The first line should be either blank or the text you'd
            like to use for the resulting document. There should be no hash (#)
            mark on this line. Use a blank line at the start of your data for 
            no title. 
        </p>
        <textarea disabled id="example-code">
Document Title

# Section Title
## Subsection Title
012345678901, Product Description
        </textarea>
        <p>
            Note: UPCs are 12 digits long. The text box below uses a fixed-width
            font so that you can tell when one of your UPCs is wrong. If you
            are copying UPCs from certain Kroger sources, you'll need to fuss with
            the numbers a bit: only take the last 11 digits. There's a stupid reason
            for this that I won't bore you with, but if you're interested in learning
            more, it's called a check digit. Some Kroger codes are missing this digit.
            Don't worry, the font computes this for us automatically, you just need
            the last 11.
        </p>
        <p>
            The button below the text input will insert data which exemplifies the format. 
        </p>
    </details>
    <textarea name="data" id="data" cols="100" rows="32"></textarea><br>
    <button id="submit">Create Document</button>
    <button id="example">Insert Example Data</button>
    <script>const isHeading = (line) => line[0] === "#";
const isSubHeading = (line) => line.slice(0,2) === "##";

window.onload = () => {
    console.log(".");

    const groups = [];
    
    document.getElementById("example").addEventListener("click", (ev) => {
        document.getElementById("data").value = exampleData;
    });

    document.getElementById("submit").addEventListener("click", (ev) => {
        // console.log(document.getElementById("data").value);
        const data = document.getElementById("data").value.split("\n");

        document.body.innerHTML = "";
        
        if (data[0] != undefined) {
            const title = document.createElement("h1");
            title.innerText = data[0];
            document.body.appendChild(title);
            document.title = data[0];
        }

        for (let i = 1; i < data.length; i++) {
            if (data[i] === undefined) continue;
            if (isHeading(data[i])) {
                if (data[i] === undefined) continue;

                // This is a headline, start a new UPC group
                let heading;
                if (isSubHeading(data[i])) {
                    console.log("hah");
                    heading = document.createElement("h4");
                    heading.innerText = data[i].trim().replace("## ", "");
                } else {
                    heading = document.createElement("h2");
                    heading.innerText = data[i].trim().replace("# ", "");
                }
                document.body.appendChild(heading);
                const div_upc_group = document.createElement("div");
                div_upc_group.classList.add("flex");

                while (data[++i] && !isHeading(data[i]) && i < data.length) {
                    console.log(data[i]);
                    if (data[i] === undefined) continue;
                    const [upc, title, desc] = data[i].split(", ");
                    if (!upc) continue;

                    const div_item = document.createElement("div");
                    div_item.classList.add("flex-item");

                    const p_barcode = document.createElement("p");
                    p_barcode.innerText = upc.length === 12 ? upc : upc + "?";
                    p_barcode.classList.add("barcode");
                    div_item.appendChild(p_barcode);

                    if (title) {
                        const p_title = document.createElement("p");
                        p_title.innerText = title;
                        div_item.appendChild(p_title);
                    }

                    if (desc) {
                        const p_desc = document.createElement("p");
                        p_desc.innerText = desc;
                        div_item.appendChild(p_desc);
                    }

                    div_upc_group.appendChild(div_item);
                }
                document.body.appendChild(div_upc_group);
                --i;
            }
        }
    });
};

const exampleData = 
`Deli Department Catalogs

# Catalog 59 (Frozen)

## Frozen Chicken
07701314569, Pilgrim Chicken Tender Jumbo
07701314569, Pilgrim Bread Chicken Tender RTE
07701314570, Pilgrims Breaded Wings Boneless
07701314571, Pilgrim Breaded Bone In Wings RTE
07701316787, Pilgrims Roasted Wings RTE
07701316813, Pilgrims Sizzlin Hot Wings RTE
07701314572, FFMKT POPCORN CKN

## Other
64220553788, FMKT TURKY SPLT BRST
84013430706, HMCF STL RIBS FULL SLAB C
04771709103, SEASONED SHREDDED PORK CA
04497900417, LBWN CRCKL CUT POTATO WDG
28684780000, DELI PULLED PORK BBQ C
28661980000, DELI PULLED CKN BBQ C
02802915642, TRSF TRIDENT POLLOCK FISH

## Salad Case
28661980000, Mont Inn BBQ Chicken
28684780000, Mont Inn BBQ Pork

# Catalog 34 (Shared Perishable)

## Salad Case POG
21974900000, Banana Pudding
03022311604, Buffalo Chicken Salad
03022311090, Chicken Salad
03022311091, Queen City Chkn Sld w/ Grp & Pcn
03022311444, Loaded Potato Salad
07111700188, Macaroni Salad
03022311414, Pesto Chicken Salad
23222200000, Spicy Italian Pasta Salad
24733780000, Summer Slaw

## Other Salads
01345438398, ANTIPASTA PASTA SALAD
07111711439, RESERS SEAFOOD SALAD KIT
03022309223, DELI SUMMER SLAW
01111074048, KRO CRNBY CELEBRT SALAD
07111700188, RESERS MACARONI SALAD
07111700280, RESERS PISTACHIO DELIGHT
07111710932, PINA COLADA DELIGHT
01111092020, KRO STRAWBRY CHEESECAKE
01111092033, KB BANANA PUDDING

## Production
75410200022, CLASSIC DEVILED EGG KIT
07750901250, OZRK BEAN DIP KIT
08919370132, OJCK FDSRV LAHVASH
03614406240, GEHLS PRM NACHO CHS SCE
07015329916, RNDL RNCH WHP CRM CHS
01111062765, HMCF RSTD PLLD CKN
84013430481, HMCF CHDR MAC CHS
01345438399, RESERS PEPPERONI PIZZA
84013430436, HMCF CARNE ASADA ST TACO
84013430435, RESERS FH CKN ST TACO
84013430852, HMCF ASIAN CKN STR FRY
07705231258, MILL ROSE FRM SLCD PPPRNI

## Bulk Cheese
03614406240, Gehl's Nacho Cheese
01111058673, KRO YELLOW AMERICAN CHS
01111058674, KRO WHITE AMERICAN CHS
03450048107, LOL YLW AMERICAN CHEESE
01111060715, PRSL BABY SWISS CHEESE
01111060716, PRSL COLBY JACK HORN CHS
01111060719, PRSL COLBY MINI HORN
01111062268, PS FUEGO JACK
01111058364, PRSL GOUDA AGED CHS
01111000274, PRSL HAVARTI PLAIN
01111060718, PRSL MILD CHEDDAR CHEESE
01111000041, PRSL MUENSTER CHEESE
01111060717, PRSL PEPPERJACK LOAF CHS
01111009857, PRSL PROVOLONE CHEESE RW
01111062304, PRSL SMOKED PROVOLONE
01111009726, PRSL SHARP CHEDDAR
01111060724, PRSL SWISS CHEESE LOAF

## GNG
01111022290, KRO YELLOW AMER CHS GNG
01111022291, KRO WHT AMER CHS GNG
01111022284, PRSL COLBY JCK GNG
01111022285, PRSL COLBY CHS GNG
01111010796, PRSL PEPPERJACK GNG CHS
01111022287, PRSL PROVOLONE CHS GNG
01111009763, PRSL SHARP CHEDDAR GNG
01111022289, PRSL BBY SWISS SLCD GNG
01111022288, PRSL SWISS CHS SLCD GNG
01111061627, PS SLICED PEPPERED TURKEY
01111007174, PRSL GENOA SALAMI SLD
01111007173, PRSL HARD SALAMI SLCD
01111007172, PRSL PEPPERONI SLICED
01111095558, PRSL WLDFLWR HNY HAM
01111095559, PRSL WLDFLOWR HNY TURKEY
01111095557, PRSL MESQUITE TRKY
01111060884, PRSL OVN RSTD TURKEY BRST
01111060885, PRSL BRWN SUGAR HAM

## Bulk Beef
01111060263, PRSL Angus Roast Beef Medium
01111007112, PRSL Choice Corn Beef
01111007111, PRSL Choice Pastrami
01111099503, PRSL Choice Roast Beef Well

## Bulk Ham
01111099024, PRSL Black Forest Ham 2x 8#
01111099415, PRSL Brown Sugar Ham 4x 3-5.5# 
01111060885, PS Brown Sugar Ham 6x 3#
01111058876, PS Tavern Ham
01111018103, PS Honey Ham Half 4x 5.35# 

## Bulk Turkey
01111099498, PS Mesquite Turkey 2x 8.5#
01111099496, PS Oven Turkey 2x 9#
01111099497, PS Honey Turkey 2x 9.65#
01111061242, PS Blackened Turkey
01111060734, PS Pepper Turkey

## Bulk Chicken
01111022351, PS Hot Honey Chicken
01111058667, PS Gold Chicken LS

## Loaves
04450006131, Kahn's Deluxe Club Bologna
01111052230, PS Beef Bologna
01111060273, PS Genoa Salami 
01111060274, PS Hard Salami
01111019000, PS Pickle Pepper Loaf
01111099838, PS Pepperoni
01111061976, PS Soppressata

## Hot Sides
01111037260, KRO CRMY MAC CHEESECAKE
01111038666, KRO MASHED POTATOES
01111095212, KROGER TURKEY GRAVY
07464101201, CFRS KERNEL CORN COOKED

# Catalog 58 (Meat)

## Chicken
07029216392, S M DELI CHKN BRD II
07701306247, Lemon Pepper
04172302345, PGPR CUT UP CKN
07563245811, PGPR CKN TENDER JUMBO
07563293085, MARINATED CHICKEN DRUMSTICK
84013430006, PILG SAV RSTD CKN
84013430007, HMCF GRLC HRB WHL CKN
07496035810, ST DELI CKN

# Catalog 69 (Payton)
76308996794, CHICKEN BREADING
40519206794, SAVRY CHCKN SEASONING
04150001270, CATTLEMENS MEMPHIS BBQ
04150001269, FRANKS REDHOT BUFFALO WIN
01300053060, HEINZ SS MUSTARD
02100066371, KRFT INDV MRCL WHP DRSSG
01300053160, HEINZ TARTAR SAUCE
01300098320, HEINZ KETCHUP PKTS 200C
07550000003, CONDIMENTS-TX PETE PACKS
`</script>
</body>
</html>